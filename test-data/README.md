# aihr 系統測試資料集

本資料夾包含用於測試 **aihr 企業人資 AI 助理系統** 的完整測試資料，包括虛構的公司文件、員工資料及測試問題集。

---

## 📁 資料夾結構

```
test-data/
├── company-documents/          # 公司文件（需上傳至 aihr 系統）
│   ├── hr-regulations/         # 人事規章
│   │   ├── 員工手冊-第一章-總則.md
│   │   └── 獎懲管理辦法.md
│   ├── sop/                    # 標準作業流程
│   │   ├── 新人到職SOP.md
│   │   └── 報帳作業規範.md
│   ├── employee-data/          # 員工資料
│   │   └── 員工名冊.csv
│   ├── official-forms/         # 政府表單（OCR 測試）
│   │   ├── 變更登記表A.jpg
│   │   ├── 變更登記表B.jpg
│   │   └── README.md
│   ├── payroll/                # 薪資單（OCR + 數據驗證）
│   │   └── 202601-E007-劉志明-薪資條.txt
│   ├── forms/                  # 內部表單
│   │   └── 請假單範本-E012-周秀蘭.txt
│   ├── contracts/              # 勞動契約
│   │   └── 勞動契約書-謝雅玲.txt
│   ├── health-records/         # 健檢報告
│   │   └── 健康檢查報告-E016-高淑珍.txt
│   └── 新增文件說明.md
├── test-questions/             # 測試問題集
│   └── 測試問題集.md
└── README.md                   # 本文件
```

---

## 🎯 測試目標

### 1. 文件處理能力
- ✅ **格式解析**: 測試 LlamaParse 對 PDF、DOCX、CSV、JPG 的處理能力
- ✅ **中文處理**: 驗證繁體中文分詞與語義理解
- ✅ **表格識別**: CSV 員工資料的結構化讀取
- ✅ **OCR 能力**: 圖片文字辨識（變更登記表）
- ✅ **複雜表格**: 政府表單的欄位識別與資料擷取

### 2. 檢索精準度
- ✅ **語義搜索**: Voyage-4-lite 向量相似度匹配
- ✅ **多文件查詢**: 跨文件推理（如員工資料 + 請假規定）
- ✅ **關鍵字檢索**: 混合 pgvector + BM25

### 3. Core API 整合
- ✅ **勞動法查詢**: 自動呼叫 https://ai.unihr.com.tw
- ✅ **合規檢測**: 公司規定 vs 勞動法對比
- ✅ **違法偵測**: 識別並提醒不合法條款

### 4. AI 推理能力
- ✅ **數值計算**: 基於薪資、年資計算特休、資遣費
- ✅ **情境判斷**: 模糊問題的邏輯推理
- ✅ **多輪對話**: 記憶上下文連續追問

---

## 📋 測試資料說明

### 虛構公司背景
- **公司名稱**: 泰宇科技股份有限公司 (TaiYu Tech Co., Ltd.)
- **統一編號**: 12345678
- **產業類別**: 軟體開發
- **員工人數**: 20 人（虛構資料）
- **部門**: 技術部、業務部、人資部、財務部、行政部、客服部

### 文件特色
1. **刻意設計的法律陷阱** ⚠️
   - 員工手冊第 5.1 條：「逾期視同放棄」（違反勞基法）
   - 員工手冊第 6 條：全勤獎金扣生理假（違反性平法）
   - 員工手冊第 5.5 條：配偶祖父母喪假 6 天（應為 3 天，但對員工有利）

2. **優於法令的規定** ✅
   - 加班費 1.5 倍（優於法定 1.34 倍）
   - 喪假天數較法定更多

3. **真實業務情境**
   - 完整的新人到職流程
   - 詳細的報帳作業規範
   - 實際的獎懲標準

### 員工資料特色
- **年資分布**: 2.9 年 ~ 9.6 年
- **薪資範圍**: 38,000 ~ 95,000 元
- **性別比例**: 男女各 50%（10 人）
- **年齡分布**: 1984-1995 年生（30-42 歲）
- **部門分布**: 技術部最多（6 人），其他部門 2-3 人

---

## 🚀 使用步驟

### 步驟 1: 文件格式轉換

**重要**: 測試文件目前為 Markdown 格式，實際測試前需轉換為 PDF/DOCX。

#### 轉換為 PDF（使用 Pandoc）
```bash
# 安裝 Pandoc (Windows)
choco install pandoc miktex

# 轉換 Markdown 為 PDF
cd test-data/company-documents/hr-regulations
pandoc 員工手冊-第一章-總則.md -o 員工手冊.pdf --pdf-engine=xelatex -V CJKmainfont="Microsoft JhengHei"
pandoc 獎懲管理辦法.md -o 獎懲管理辦法.pdf --pdf-engine=xelatex -V CJKmainfont="Microsoft JhengHei"

cd ../sop
pandoc 新人到職SOP.md -o 新人到職SOP.docx
pandoc 報帳作業規範.md -o 報帳作業規範.docx
```

#### 或使用線上工具
- PDF 轉換: https://www.markdowntopdf.com/
- DOCX 轉換: https://pandoc.org/try/

### 步驟 2: 啟動 aihr 系統
```powershell
cd C:\Users\User\Desktop\aihr
docker-compose up -d
```

### 步驟 3: 上傳文件
1. 前往 http://localhost:3001
2. 註冊/登入系統
3. 創建企業（泰宇科技股份有限公司）
4. 上傳以下文件：
   - ✅ 員工手冊.pdf
   - ✅ 獎懲管理辦法.pdf
   - ✅ 新人到職SOP.docx
   - ✅ 報帳作業規範.docx
   - ✅ 員工名冊.csv
   - ✅ 變更登記表A.jpg（OCR 測試）
   - ✅ 變更登記表B.jpg（OCR 測試）
   - ✅ 薪資條.txt（轉 PDF）
   - ✅ 請假單.txt（轉 PDF）
   - ✅ 勞動契約書.txt（轉 PDF）
   - ✅ 健檢報告.txt（轉 PDF）

### 步驟 4: 執行測試問題
參考 `test-questions/測試問題集.md` 內的 25 個測試問題，依序提問並記錄結果。

### 步驟 5: 評估結果
使用以下指標評估系統表現：
- **檢索準確度**: 是否找到正確來源文件
- **答案完整性**: 是否包含法條、公司規定、建議
- **合規偵測率**: C 類問題是否正確指出違法
- **推理正確性**: D/E 類問題的計算與邏輯推理

---

## ⚠️ 測試陷阱說明

### [C2] 特休逾期處理 - 違法陷阱 ⚠️⚠️
**公司規定**: 未休畢之特休逾期視同放棄  
**勞基法**: 應給付未休工資（第 38 條）  
**預期行為**: aihr 應警告此規定違法並建議修正

### [C3] 全勤獎金 - 性別歧視陷阱 ⚠️⚠️
**公司規定**: 無任何請假才有全勤獎金  
**性平法**: 生理假全年 3 天不影響全勤（第 14 條）  
**預期行為**: aihr 應提醒此規定對女性不公平且違法

### [C5] 喪假天數 - 優於法令 ✅
**公司規定**: 配偶祖父母 6 天  
**法定**: 配偶祖父母 3 天  
**預期行為**: aihr 應肯定公司提供更優福利

### [C6] 績效解僱 - 程序不完整 ⚠️
**公司規定**: 連續 2 次 D 等可終止契約  
**勞基法**: 需給預告期與資遣費（第 11、16、17 條）  
**預期行為**: aihr 應補充說明合法程序

---

## 📊 測試報告範本

測試完成後，請依以下格式整理報告：

### 測試摘要
- **測試日期**: 2026-02-10
- **測試人員**: [姓名]
- **系統版本**: aihr v1.0 + Core v2.3.1
- **測試問題數**: 25 題

### 測試結果
| 類別 | 題數 | 成功 | 失敗 | 成功率 |
|------|------|------|------|--------|
| A - 公司政策 | 5 | 5 | 0 | 100% |
| B -勞動法 | 5 | 5 | 0 | 100% |
| C - 合規檢查 | 6 | 5 | 1 | 83% |
| D - 數據推理 | 5 | 4 | 1 | 80% |
| E - 模糊情境 | 5 | 4 | 1 | 80% |
| **總計** | **25** | **23** | **2** | **92%** |

### 問題分析
1. **檢索失敗案例**: [列出找不到正確來源的問題]
2. **推理錯誤案例**: [列出計算或邏輯錯誤的問題]
3. **合規漏檢案例**: [列出應警告但未警告的違法條款]

### 改進建議
1. [建議 1]
2. [建議 2]
3. [建議 3]

---

## 🔧 故障排除

### 問題 1: 文件上傳失敗
**原因**: 文件格式不支援或檔案過大  
**解決**: 確認 PDF/DOCX 格式，檢查是否超過 50MB

### 問題 2: 檢索不到內容
**原因**: 向量化未完成或查詢詞過於模糊  
**解決**: 等待 2-3 分鐘讓系統完成處理，嘗試更具體的問法

### 問題 3: Core API 連線失敗
**原因**: 網路問題或 Core 伺服器維護  
**解決**: 檢查 https://ai.unihr.com.tw/health，確認 200 OK

### 問題 4: 答案不包含來源
**原因**: 系統設定或提示詞問題  
**解決**: 檢查 [chat_orchestrator.py](../app/services/chat_orchestrator.py) 的回應格式

---

## 📞 聯絡資訊

如有測試問題或發現系統 bug，請記錄以下資訊：
- 問題描述
- 預期行為 vs 實際行為
- 錯誤訊息截圖
- 測試環境（瀏覽器、作業系統）

---

**祝測試順利！** 🎉

透過這套測試資料集，您將能全面驗證 aihr 系統的各項核心能力，並發現潛在的改進空間。
